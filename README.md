# ðŸ¥”ðŸŽ° POTATO Tipper contract - [![Build + Test pass](https://github.com/Stakingverse/pool-contracts/actions/workflows/build-test.yml/badge.svg)](https://github.com/Stakingverse/pool-contracts/actions/workflows/build-test.yml) [![Code coverage](https://img.shields.io/badge/Code_Coverage-87%25-green?logo=codecrafters&logoColor=white)](./README.md#code-coverage)

Smart contracts of the POTATO Tipper, a contract that enables you to tip on follow.

## Overview

Soon...

## Code Coverage

```
â•­----------------------+----------------+----------------+---------------+---------------â•®
| File                 | % Lines        | % Statements   | % Branches    | % Funcs       |
+========================================================================================+
| src/PotatoTipper.sol | 95.45% (42/44) | 95.24% (40/42) | 85.71% (6/7)  | 100.00% (8/8) |
â•°----------------------+----------------+----------------+---------------+---------------â•¯

Uncovered for src/PotatoTipper.sol:
- Line (location: source ID 102, lines 137..138, bytes 14351..14408, hits: 0)
- Statement (location: source ID 102, lines 137..138, bytes 14351..14408, hits: 0)
- Branch (branch: 13, path: 0) (location: source ID 102, lines 234..237, bytes 19179..19277, hits: 0)
- Line (location: source ID 102, lines 235..236, bytes 19197..19262, hits: 0)
- Statement (location: source ID 102, lines 235..236, bytes 19197..19262, hits: 0)
```

## Development

### Pre-requisites

1. Install the [**`bun`** package manager](https://bun.sh/package-manager).
2. [Install foundry](https://getfoundry.sh/).
3. Install the dependencies

```bash
forge install
bun install

# Compile the contracts (ABI + generated bytecode in `build/` folder)
bun run build

# Bun commands for tests below uses under the hood the flag `--fork-url https://rpc.mainnet.lukso.network`

# Run fork tests against LUKSO mainnet
bun run test

# Run fork tests + display gas report
bun run test:gas

# Run fork tests + show code coverage
bun run test:coverage

# Format Solidity code
# Formatting rules can be adjusted under the `[fmt]` section in the `foundry.toml` file
bun run format
```

### Gas report

```log
[PASS] test_FollowerDoesNotAlreadyFollowUser() (gas: 15200)
[PASS] test_FollowerFollowUser() (gas: 182328)
[PASS] test_IsLSP1Delegate() (gas: 8391)
[PASS] test_PotatoTipperIsRegisteredForNotificationTypeNewFollower() (gas: 17195)
[PASS] test_cannotTipTwiceTheSameNewFollowerIfFollowedUnfollowAndRefollow() (gas: 676043)
Logs:
  Found UniversalReceiver event related to a typeId new follow at index: 5

[PASS] test_followerCanReceiveTipsFromTwoDifferentUsersWhoConnectedPotatoTipper() (gas: 855803)
[PASS] test_shouldNotTipIfPotatoTipperHasNotBeenAuthorizedAsOperator() (gas: 205597)
[PASS] test_tippingOnFollowAfterAuthorizingPotatoTipperAsOperator() (gas: 438184)
```

### Documentation

This template repository is based on Foundry, **a blazing fast, portable and modular toolkit for EVM application development written in Rust.** It includes:

- **Forge**: Ethereum testing framework (like Truffle, Hardhat and DappTools).
- **Cast**: Swiss army knife for interacting with EVM smart contracts, sending transactions and getting chain data.
- **Anvil**: Local Ethereum node, akin to Ganache, Hardhat Network.
- **Chisel**: Fast, utilitarian, and verbose solidity REPL.

You can find more documentation at: https://book.getfoundry.sh/
